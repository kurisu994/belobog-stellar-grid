<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>æ ‘å½¢æ•°æ®å¯¼å‡ºç¤ºä¾‹ - belobog-stellar-grid</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }
      body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
        padding: 40px 20px;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
      }
      .container {
        max-width: 900px;
        margin: 0 auto;
        background: white;
        padding: 40px;
        border-radius: 12px;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
      }
      h1 {
        color: #333;
        margin-bottom: 10px;
        font-size: 32px;
      }
      .subtitle {
        color: #666;
        margin-bottom: 30px;
        font-size: 14px;
      }
      .section {
        margin-bottom: 40px;
      }
      .section h2 {
        color: #444;
        margin-bottom: 15px;
        font-size: 20px;
        border-left: 4px solid #667eea;
        padding-left: 12px;
      }
      .section p {
        color: #666;
        margin-bottom: 15px;
        line-height: 1.6;
      }
      .button-group {
        display: flex;
        gap: 12px;
        flex-wrap: wrap;
        margin: 20px 0;
      }
      button {
        padding: 12px 24px;
        font-size: 14px;
        font-weight: 600;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        transition: all 0.3s ease;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        min-width: 140px;
      }
      .btn-primary {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
      }
      .btn-primary:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
      }
      .btn-excel {
        background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
        color: white;
      }
      .btn-excel:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(40, 167, 69, 0.4);
      }
      .btn-orange {
        background: linear-gradient(135deg, #ff9966 0%, #ff5e62 100%);
        color: white;
      }
      .btn-orange:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(255, 94, 98, 0.4);
      }
      button:active {
        transform: translateY(0);
      }
      .code {
        background: #e8f0fe;
        padding: 2px 8px;
        border-radius: 3px;
        font-family: "Courier New", monospace;
        color: #5f6368;
      }
      pre {
        background: #282c34;
        color: #abb2bf;
        padding: 20px;
        border-radius: 8px;
        overflow-x: auto;
        font-size: 13px;
        line-height: 1.6;
        margin-bottom: 20px;
      }
      pre .keyword {
        color: #c678dd;
      }
      pre .string {
        color: #98c379;
      }
      pre .comment {
        color: #5c6370;
        font-style: italic;
      }
      pre .number {
        color: #d19a66;
      }
      pre .func {
        color: #61afef;
      }
      .info-box {
        background: #e6f7ff;
        border: 1px solid #91d5ff;
        border-radius: 8px;
        padding: 15px 20px;
        margin-bottom: 20px;
        color: #0050b3;
        font-size: 14px;
      }
      .info-box strong {
        color: #003a8c;
      }
      .data-preview {
        background: #f8f9fa;
        border: 1px solid #e9ecef;
        border-radius: 8px;
        padding: 16px 20px;
        margin-bottom: 20px;
      }
      .data-preview h3 {
        color: #495057;
        font-size: 14px;
        margin-bottom: 10px;
      }
      .data-preview pre {
        background: #282c34;
        margin-bottom: 0;
        font-size: 13px;
      }
      .status {
        padding: 12px 16px;
        border-radius: 6px;
        margin-top: 10px;
        display: none;
        font-size: 14px;
        font-weight: 500;
      }
      .status.success {
        display: block;
        background: #f6ffed;
        color: #389e0d;
        border: 1px solid #b7eb8f;
      }
      .status.error {
        display: block;
        background: #fff2f0;
        color: #cf1322;
        border: 1px solid #ffa39e;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>ğŸŒ³ æ ‘å½¢æ•°æ®å¯¼å‡º</h1>
      <p class="subtitle">
        ä½¿ç”¨ <span class="code">export_data()</span> å°†åµŒå¥—çš„ children ç»“æ„é€’å½’æ‹å¹³åå¯¼å‡ºï¼Œ<strong>æ”¯æŒå±‚çº§ç¼©è¿›</strong>
      </p>

      <div class="info-box">
        <strong>ğŸ’¡ é€‚ç”¨åœºæ™¯ï¼š</strong>
        ç»„ç»‡æ¶æ„ã€å•†å“åˆ†ç±»ã€èœå•ç›®å½•ç­‰å…·æœ‰çˆ¶å­å…³ç³»çš„æ•°æ®ã€‚ é€šè¿‡ <span class="code">indent_column</span> å’Œ
        <span class="code">children_key</span> å‚æ•°æ§åˆ¶ç¼©è¿›ä¸å­èŠ‚ç‚¹å­—æ®µã€‚
      </div>

      <!-- åœºæ™¯ 1ï¼šåŸºæœ¬æ ‘å½¢ç»“æ„ -->
      <div class="section">
        <h2>åœºæ™¯1: ç»„ç»‡æ¶æ„å¯¼å‡º</h2>
        <p>å…¸å‹çš„æ ‘å½¢æ•°æ®â€”â€”å…¬å¸ç»„ç»‡æ¶æ„ï¼Œä½¿ç”¨ <span class="code">children</span> è¡¨ç¤ºä¸Šä¸‹çº§å…³ç³»ï¼š</p>

        <pre><span class="keyword">const</span> orgData = [
    {
        id: <span class="number">1</span>, name: <span class="string">'CEO - å¼ ä¸‰'</span>, title: <span class="string">'CEO'</span>, level: <span class="string">'é«˜ç®¡'</span>,
        children: [
            {
                id: <span class="number">2</span>, name: <span class="string">'CTO - æå››'</span>, title: <span class="string">'CTO'</span>, level: <span class="string">'é«˜ç®¡'</span>,
                children: [
                    { id: <span class="number">5</span>, name: <span class="string">'å‰ç«¯ç»„é•¿ - ç‹äº”'</span>, title: <span class="string">'ç»„é•¿'</span>, level: <span class="string">'ä¸­å±‚'</span> },
                    { id: <span class="number">6</span>, name: <span class="string">'åç«¯ç»„é•¿ - èµµå…­'</span>, title: <span class="string">'ç»„é•¿'</span>, level: <span class="string">'ä¸­å±‚'</span> },
                ]
            },
            { id: <span class="number">3</span>, name: <span class="string">'CFO - å­™ä¸ƒ'</span>, title: <span class="string">'CFO'</span>, level: <span class="string">'é«˜ç®¡'</span>, children: [...] },
            { id: <span class="number">4</span>, name: <span class="string">'COO - å´ä¹'</span>, title: <span class="string">'COO'</span>, level: <span class="string">'é«˜ç®¡'</span> },
        ]
    }
];

<span class="keyword">const</span> columns = [
    { title: <span class="string">'ID'</span>, key: <span class="string">'id'</span> },
    { title: <span class="string">'å§“å'</span>, key: <span class="string">'name'</span> },
    { title: <span class="string">'èŒä½'</span>, key: <span class="string">'title'</span> },
    { title: <span class="string">'å±‚çº§'</span>, key: <span class="string">'level'</span> },
];

<span class="comment">// æ™®é€šå¯¼å‡º</span>
<span class="func">export_data</span>(orgData, columns, <span class="string">'ç»„ç»‡æ¶æ„.xlsx'</span>, ExportFormat.Xlsx);

<span class="comment">// å¸¦ç¼©è¿›å¯¼å‡ºï¼ˆindent_column + children_keyï¼‰</span>
<span class="func">export_data</span>(orgData, columns, <span class="string">'ç»„ç»‡æ¶æ„_ç¼©è¿›.xlsx'</span>, ExportFormat.Xlsx,
    <span class="keyword">undefined</span>,    <span class="comment">// progress_callback</span>
    <span class="string">'name'</span>,       <span class="comment">// indent_column - ç¼©è¿›"å§“å"åˆ—</span>
    <span class="string">'children'</span>,   <span class="comment">// children_key</span>
);</pre>

        <div class="button-group">
          <button class="btn-primary" onclick="exportScenario1('csv')">ğŸ“„ å¯¼å‡º CSV</button>
          <button class="btn-excel" onclick="exportScenario1('xlsx')">ğŸ“— å¯¼å‡º Excel</button>
          <button class="btn-primary" onclick="exportScenario1('csv', true)">ğŸ“„ CSV (å¸¦ç¼©è¿›)</button>
          <button class="btn-excel" onclick="exportScenario1('xlsx', true)">ğŸ“— Excel (å¸¦ç¼©è¿›)</button>
        </div>
        <div id="status1" class="status"></div>
      </div>

      <!-- åœºæ™¯ 2ï¼šå¤šçº§åˆ†ç±»ç›®å½• -->
      <div class="section">
        <h2>åœºæ™¯2: å•†å“åˆ†ç±»ç›®å½•</h2>
        <p>ç”µå•†å¸¸è§çš„å¤šçº§åˆ†ç±»æ ‘ï¼Œæ”¯æŒè‡ªå®šä¹‰å­èŠ‚ç‚¹å­—æ®µåï¼ˆå¦‚ <span class="code">subCategories</span>ï¼‰ï¼š</p>

        <pre><span class="keyword">const</span> categoryData = [
    {
        id: <span class="number">1</span>, name: <span class="string">'ç”µå­äº§å“'</span>, code: <span class="string">'ELEC'</span>,
        subCategories: [
            { id: <span class="number">2</span>, name: <span class="string">'æ‰‹æœº'</span>, code: <span class="string">'PHONE'</span>,
              subCategories: [
                  { id: <span class="number">5</span>, name: <span class="string">'æ™ºèƒ½æ‰‹æœº'</span>, code: <span class="string">'SMART'</span> },
                  { id: <span class="number">6</span>, name: <span class="string">'åŠŸèƒ½æ‰‹æœº'</span>, code: <span class="string">'FEATURE'</span> },
              ] },
            { id: <span class="number">3</span>, name: <span class="string">'ç”µè„‘'</span>, code: <span class="string">'PC'</span>, subCategories: [...] },
        ]
    },
    { id: <span class="number">4</span>, name: <span class="string">'æœè£…'</span>, code: <span class="string">'CLOTH'</span>, subCategories: [...] },
];

<span class="keyword">const</span> columns = [
    { title: <span class="string">'ID'</span>, key: <span class="string">'id'</span> },
    { title: <span class="string">'åˆ†ç±»åç§°'</span>, key: <span class="string">'name'</span> },
    { title: <span class="string">'ç¼–ç '</span>, key: <span class="string">'code'</span> },
];

<span class="comment">// è‡ªå®šä¹‰ children_key ä¸º 'subCategories'</span>
<span class="func">export_data</span>(categoryData, columns, <span class="string">'å•†å“åˆ†ç±».xlsx'</span>, ExportFormat.Xlsx,
    <span class="keyword">undefined</span>,          <span class="comment">// progress_callback</span>
    <span class="string">'name'</span>,              <span class="comment">// indent_column</span>
    <span class="string">'subCategories'</span>,    <span class="comment">// è‡ªå®šä¹‰ children_key</span>
);</pre>

        <div class="button-group">
          <button class="btn-excel" onclick="exportScenario2()">ğŸ“— å¯¼å‡º Excelï¼ˆå¸¦ç¼©è¿›ï¼‰</button>
        </div>
        <div id="status2" class="status"></div>
      </div>

      <!-- åœºæ™¯ 3ï¼šåµŒå¥—è¡¨å¤´ + æ ‘å½¢æ•°æ® -->
      <div class="section">
        <h2>åœºæ™¯3: åµŒå¥—è¡¨å¤´ + æ ‘å½¢æ•°æ®</h2>
        <p>è¡¨å¤´é…ç½®ä¸ºå¤šå±‚åµŒå¥—ç»“æ„ï¼ˆåˆ†ç»„åˆ—ï¼‰ï¼Œæ•°æ®ä¹Ÿæ˜¯æ ‘å½¢ç»“æ„ã€‚è¡¨å¤´åµŒå¥—æ§åˆ¶åˆ—çš„åˆ†ç»„åˆå¹¶ï¼Œæ•°æ®åµŒå¥—æ§åˆ¶è¡Œçš„å±‚çº§æ‹å¹³ï¼š</p>

        <pre><span class="keyword">const</span> nestedColumns = [
    { title: <span class="string">'éƒ¨é—¨'</span>, key: <span class="string">'dept'</span> },
    { title: <span class="string">'è¯¦æƒ…'</span>, children: [
        { title: <span class="string">'è´Ÿè´£äºº'</span>, key: <span class="string">'leader'</span> },
        { title: <span class="string">'äººæ•°'</span>, key: <span class="string">'count'</span> },
    ]},
];

<span class="keyword">const</span> deptTreeData = [
    {
        dept: <span class="string">'æŠ€æœ¯éƒ¨'</span>, leader: <span class="string">'å¼ ä¸‰'</span>, count: <span class="number">100</span>,
        children: [
            { dept: <span class="string">'å‰ç«¯ç»„'</span>, leader: <span class="string">'æå››'</span>, count: <span class="number">30</span> },
            { dept: <span class="string">'åç«¯ç»„'</span>, leader: <span class="string">'ç‹äº”'</span>, count: <span class="number">70</span>,
              children: [
                  { dept: <span class="string">'æ•°æ®åº“ç»„'</span>, leader: <span class="string">'èµµå…­'</span>, count: <span class="number">20</span> },
              ] },
        ]
    },
];

<span class="comment">// å¯¼å‡ºæ•ˆæœï¼ˆExcel ä¸­ï¼‰:</span>
<span class="comment">// | éƒ¨é—¨     |    è¯¦æƒ…        |</span>
<span class="comment">// |          | è´Ÿè´£äºº |  äººæ•°  |</span>
<span class="comment">// |   æŠ€æœ¯éƒ¨  |  å¼ ä¸‰  |  100  |</span>
<span class="comment">// |   â”œ å‰ç«¯ç»„|  æå››  |   30  |</span>

<span class="func">export_data</span>(deptTreeData, nestedColumns, <span class="string">'éƒ¨é—¨æ¶æ„.xlsx'</span>, ExportFormat.Xlsx,
    <span class="keyword">undefined</span>,    <span class="comment">// progress_callback</span>
    <span class="string">'dept'</span>,       <span class="comment">// indent_column</span>
    <span class="string">'children'</span>,   <span class="comment">// children_key</span>
);</pre>

        <div class="button-group">
          <button class="btn-excel" onclick="exportScenario3()">ğŸ“— å¯¼å‡º Excelï¼ˆåµŒå¥—è¡¨å¤´ + æ ‘å½¢æ•°æ®ï¼‰</button>
        </div>
        <div id="status3" class="status"></div>
      </div>

      <!-- åœºæ™¯ 4ï¼šå¤§æ•°æ®é‡æ ‘ -->
      <div class="section">
        <h2>åœºæ™¯4: å¤§æ•°æ®é‡æ ‘å½¢ç»“æ„</h2>
        <p>åŠ¨æ€ç”ŸæˆåŒ…å«æ•°ç™¾ä¸ªèŠ‚ç‚¹çš„æ ‘å½¢æ•°æ®ï¼Œæµ‹è¯•æ€§èƒ½ï¼š</p>

        <pre><span class="comment">// åŠ¨æ€ç”Ÿæˆ 5^4 = 625 ä¸ªå¶å­èŠ‚ç‚¹çš„æ ‘</span>
<span class="keyword">const</span> data = <span class="func">generateLargeTree</span>(<span class="number">4</span>, <span class="number">5</span>);

<span class="keyword">const</span> columns = [
    { title: <span class="string">'ID'</span>, key: <span class="string">'id'</span> },
    { title: <span class="string">'åç§°'</span>, key: <span class="string">'name'</span> },
    { title: <span class="string">'å€¼'</span>, key: <span class="string">'value'</span> },
    { title: <span class="string">'çŠ¶æ€'</span>, key: <span class="string">'status'</span> },
];

<span class="func">export_data</span>(data, columns, <span class="string">'å¤§æ•°æ®é‡æ ‘.xlsx'</span>, ExportFormat.Xlsx,
    <span class="keyword">undefined</span>,    <span class="comment">// progress_callback</span>
    <span class="string">'name'</span>,       <span class="comment">// indent_column</span>
    <span class="string">'children'</span>,   <span class="comment">// children_key</span>
);</pre>

        <div class="button-group">
          <button class="btn-orange" onclick="exportScenario4()">ğŸ“— å¯¼å‡º Excelï¼ˆ500+ èŠ‚ç‚¹ï¼‰</button>
        </div>
        <div id="status4" class="status"></div>
      </div>

      <!-- API æ¦‚è§ˆ -->
      <div class="section">
        <h2>ğŸ’¡ æ ‘å½¢å¯¼å‡º API</h2>
        <pre><span class="comment">// æ ‘å½¢å¯¼å‡ºçš„å…³é”®å‚æ•°</span>
<span class="func">export_data</span>(
    data,              <span class="comment">// åŒ…å« children çš„åµŒå¥—å¯¹è±¡æ•°ç»„</span>
    columns,           <span class="comment">// è¡¨å¤´é…ç½®</span>
    filename,          <span class="comment">// æ–‡ä»¶å</span>
    format,            <span class="comment">// ExportFormat.Csv | ExportFormat.Xlsx</span>
    progressCallback,  <span class="comment">// è¿›åº¦å›è°ƒï¼ˆå¯é€‰ï¼‰</span>
    indentColumn,      <span class="comment">// éœ€è¦ç¼©è¿›çš„åˆ— keyï¼ˆå¦‚ 'name'ï¼‰</span>
    childrenKey,       <span class="comment">// å­èŠ‚ç‚¹å­—æ®µåï¼ˆé»˜è®¤ 'children'ï¼‰</span>
);

<span class="comment">// ç¤ºä¾‹ï¼šè‡ªå®šä¹‰ children_key</span>
<span class="func">export_data</span>(
    categoryData,
    columns,
    <span class="string">'åˆ†ç±».xlsx'</span>,
    ExportFormat.Xlsx,
    <span class="keyword">undefined</span>,
    <span class="string">'name'</span>,             <span class="comment">// ç¼©è¿›"åç§°"åˆ—</span>
    <span class="string">'subCategories'</span>,    <span class="comment">// å­èŠ‚ç‚¹å­—æ®µå</span>
);</pre>
      </div>
    </div>

    <script type="module">
      import init, { export_data, ExportFormat } from "../pkg/belobog_stellar_grid.js";

      await init();

      function showStatus(id, success, message) {
        const el = document.getElementById(id);
        el.className = success ? "status success" : "status error";
        el.textContent = message;
      }

      // ===== åœºæ™¯ 1ï¼šç»„ç»‡æ¶æ„ =====
      const orgData = [
        {
          id: 1,
          name: "CEO - å¼ ä¸‰",
          title: "CEO",
          level: "é«˜ç®¡",
          children: [
            {
              id: 2,
              name: "CTO - æå››",
              title: "CTO",
              level: "é«˜ç®¡",
              children: [
                { id: 5, name: "å‰ç«¯ç»„é•¿ - ç‹äº”", title: "ç»„é•¿", level: "ä¸­å±‚" },
                { id: 6, name: "åç«¯ç»„é•¿ - èµµå…­", title: "ç»„é•¿", level: "ä¸­å±‚" },
              ],
            },
            {
              id: 3,
              name: "CFO - å­™ä¸ƒ",
              title: "CFO",
              level: "é«˜ç®¡",
              children: [{ id: 7, name: "ä¼šè®¡ - å‘¨å…«", title: "ä¼šè®¡", level: "åŸºå±‚" }],
            },
            { id: 4, name: "COO - å´ä¹", title: "COO", level: "é«˜ç®¡" },
          ],
        },
      ];

      const orgColumns = [
        { title: "ID", key: "id" },
        { title: "å§“å", key: "name" },
        { title: "èŒä½", key: "title" },
        { title: "å±‚çº§", key: "level" },
      ];

      window.exportScenario1 = function (fmt, indent) {
        try {
          const format = fmt === "xlsx" ? ExportFormat.Xlsx : ExportFormat.Csv;
          const filename = indent ? `ç»„ç»‡æ¶æ„_ç¼©è¿›.${fmt}` : `ç»„ç»‡æ¶æ„.${fmt}`;
          export_data(
            orgData,
            orgColumns,
            filename,
            format,
            undefined, // progress_callback
            indent ? "name" : undefined, // indent_column
            indent ? "children" : undefined, // children_key
          );
          showStatus("status1", true, `âœ… å¯¼å‡ºæˆåŠŸ: ${filename}`);
        } catch (e) {
          showStatus("status1", false, `âŒ å¯¼å‡ºå¤±è´¥: ${e}`);
        }
      };

      // ===== åœºæ™¯ 2ï¼šå•†å“åˆ†ç±»ï¼ˆè‡ªå®šä¹‰ children_keyï¼‰=====
      const categoryData = [
        {
          id: 1,
          name: "ç”µå­äº§å“",
          code: "ELEC",
          subCategories: [
            {
              id: 2,
              name: "æ‰‹æœº",
              code: "PHONE",
              subCategories: [
                { id: 5, name: "æ™ºèƒ½æ‰‹æœº", code: "SMART" },
                { id: 6, name: "åŠŸèƒ½æ‰‹æœº", code: "FEATURE" },
              ],
            },
            {
              id: 3,
              name: "ç”µè„‘",
              code: "PC",
              subCategories: [
                { id: 7, name: "ç¬”è®°æœ¬", code: "LAPTOP" },
                { id: 8, name: "å°å¼æœº", code: "DESKTOP" },
              ],
            },
          ],
        },
        {
          id: 4,
          name: "æœè£…",
          code: "CLOTH",
          subCategories: [
            { id: 9, name: "ç”·è£…", code: "MALE" },
            {
              id: 10,
              name: "å¥³è£…",
              code: "FEMALE",
              subCategories: [{ id: 11, name: "è¿è¡£è£™", code: "DRESS" }],
            },
          ],
        },
      ];

      const categoryColumns = [
        { title: "ID", key: "id" },
        { title: "åˆ†ç±»åç§°", key: "name" },
        { title: "ç¼–ç ", key: "code" },
      ];

      window.exportScenario2 = function () {
        try {
          export_data(
            categoryData,
            categoryColumns,
            "å•†å“åˆ†ç±».xlsx",
            ExportFormat.Xlsx,
            undefined, // progress_callback
            "name", // indent_column
            "subCategories", // è‡ªå®šä¹‰ children_key
          );
          showStatus("status2", true, "âœ… å¯¼å‡ºæˆåŠŸ: å•†å“åˆ†ç±».xlsx");
        } catch (e) {
          showStatus("status2", false, `âŒ å¯¼å‡ºå¤±è´¥: ${e}`);
        }
      };

      // ===== åœºæ™¯ 3ï¼šåµŒå¥—è¡¨å¤´ + æ ‘å½¢æ•°æ® =====
      const nestedColumns = [
        { title: "éƒ¨é—¨", key: "dept" },
        {
          title: "è¯¦æƒ…",
          children: [
            { title: "è´Ÿè´£äºº", key: "leader" },
            { title: "äººæ•°", key: "count" },
          ],
        },
      ];

      const deptTreeData = [
        {
          dept: "æŠ€æœ¯éƒ¨",
          leader: "å¼ ä¸‰",
          count: 100,
          children: [
            { dept: "å‰ç«¯ç»„", leader: "æå››", count: 30 },
            {
              dept: "åç«¯ç»„",
              leader: "ç‹äº”",
              count: 70,
              children: [{ dept: "æ•°æ®åº“ç»„", leader: "èµµå…­", count: 20 }],
            },
          ],
        },
      ];

      window.exportScenario3 = function () {
        try {
          export_data(
            deptTreeData,
            nestedColumns,
            "éƒ¨é—¨æ¶æ„.xlsx",
            ExportFormat.Xlsx,
            undefined, // progress_callback
            "dept", // indent_column
            "children", // children_key
          );
          showStatus("status3", true, "âœ… å¯¼å‡ºæˆåŠŸ: éƒ¨é—¨æ¶æ„.xlsx");
        } catch (e) {
          showStatus("status3", false, `âŒ å¯¼å‡ºå¤±è´¥: ${e}`);
        }
      };

      // ===== åœºæ™¯ 4ï¼šå¤§æ•°æ®é‡æ ‘ =====
      function generateLargeTree(depth, breadth, prefix = "") {
        const nodes = [];
        for (let i = 1; i <= breadth; i++) {
          const id = `${prefix}${i}`;
          const node = {
            id: id,
            name: `èŠ‚ç‚¹_${id}`,
            value: Math.floor(Math.random() * 1000),
            status: Math.random() > 0.5 ? "å¯ç”¨" : "ç¦ç”¨",
          };
          if (depth > 1) {
            node.children = generateLargeTree(depth - 1, breadth, `${id}-`);
          }
          nodes.push(node);
        }
        return nodes;
      }

      const largeColumns = [
        { title: "ID", key: "id" },
        { title: "åç§°", key: "name" },
        { title: "å€¼", key: "value" },
        { title: "çŠ¶æ€", key: "status" },
      ];

      window.exportScenario4 = function () {
        try {
          const start = performance.now();
          const data = generateLargeTree(4, 5); // 5^4 = 625 å¶å­èŠ‚ç‚¹
          export_data(
            data,
            largeColumns,
            "å¤§æ•°æ®é‡æ ‘.xlsx",
            ExportFormat.Xlsx,
            undefined, // progress_callback
            "name", // indent_column
            "children", // children_key
          );
          const elapsed = (performance.now() - start).toFixed(0);
          showStatus("status4", true, `âœ… å¯¼å‡ºæˆåŠŸï¼Œè€—æ—¶: ${elapsed}ms`);
        } catch (e) {
          showStatus("status4", false, `âŒ å¯¼å‡ºå¤±è´¥: ${e}`);
        }
      };
    </script>
  </body>
</html>
