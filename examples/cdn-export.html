<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>CDN åˆ†å‘å¯¼å‡ºç¤ºä¾‹ - belobog-stellar-grid</title>
    <!-- å¼•å…¥ CDN ç‰ˆæœ¬çš„ CSS -->
    <link rel="stylesheet" href="https://unpkg.com/picocss@1.5.10/pico.min.css">
    <style>
      body {
        padding: 2rem;
        background-color: #f8f9fa;
      }
      .container {
        pointer-events: auto;
      }
      /* ç®€å•çš„åŠ è½½åŠ¨ç”» */
      .loading {
        display: inline-block;
        width: 1rem;
        height: 1rem;
        border: 2px solid rgba(0,0,0,0.1);
        border-radius: 50%;
        border-top-color: #0f172a;
        animation: spin 1s ease-in-out infinite;
        margin-right: 0.5rem;
        vertical-align: middle;
      }
      @keyframes spin {
        to { transform: rotate(360deg); }
      }
      #status-msg {
        margin-top: 1rem;
        font-weight: bold;
      }
      .success { color: #10b981; }
      .error { color: #ef4444; }
      pre {
        background: #1e1e1e;
        color: #d4d4d4;
        padding: 1rem;
        border-radius: 6px;
        overflow-x: auto;
      }
      .code-comment { color: #6a9955; }
      .code-keyword { color: #569cd6; }
      .code-function { color: #dcdcaa; }
      .code-string { color: #ce9178; }
    </style>
  </head>
  <body>
    <main class="container">
      <nav aria-label="breadcrumb">
        <ul>
          <li><a href="index.html">è¿”å›ç¤ºä¾‹åˆ—è¡¨</a></li>
          <li>CDN åˆ†å‘ç¤ºä¾‹</li>
        </ul>
      </nav>

      <article>
        <header>
          <h2>ğŸŒ CDN ç›´æ¥å¼•å…¥æ¼”ç¤º</h2>
          <p>è¿™ä¸ªé¡µé¢å±•ç¤ºäº†å¦‚ä½•åœ¨<strong>ä¸ä½¿ç”¨ä»»ä½•æ„å»ºå·¥å…·ï¼ˆå¦‚ Webpack/Viteï¼‰</strong>çš„æƒ…å†µä¸‹ï¼Œç›´æ¥é€šè¿‡ HTML <code>&lt;script type="module"&gt;</code> å¼•ç”¨å…¬ç½‘ CDN ä¸Šçš„ WASM åº“æ¥å®Œæˆè¡¨æ ¼å¯¼å‡ºã€‚</p>
        </header>

        <section>
          <h3>1. ç¤ºä¾‹æ•°æ®è¡¨æ ¼</h3>
          <p>æˆ‘ä»¬å°†ä½¿ç”¨ CDN ä¸Šçš„ <code>belobog-stellar-grid</code> å¯¼å‡ºä¸‹é¢è¿™ä¸ªè¡¨æ ¼ï¼š</p>
          <table id="demo-table" role="grid">
            <thead>
              <tr>
                <th>ID</th>
                <th>æ¡†æ¶</th>
                <th>è¯­è¨€</th>
                <th>Stars</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>1</td>
                <td>React</td>
                <td>JavaScript/TypeScript</td>
                <td>210,000+</td>
              </tr>
              <tr>
                <td>2</td>
                <td>Vue.js</td>
                <td>JavaScript/TypeScript</td>
                <td>205,000+</td>
              </tr>
              <tr>
                <td>3</td>
                <td>Svelte</td>
                <td>JavaScript/TypeScript</td>
                <td>70,000+</td>
              </tr>
              <tr>
                <td>4</td>
                <td>belobog-stellar-grid</td>
                <td>Rust/WebAssembly</td>
                <td>ğŸš€ å¢é•¿ä¸­</td>
              </tr>
            </tbody>
          </table>

          <div class="grid">
            <button id="btn-csv" class="secondary" disabled>å¯¼å‡ºä¸º CSV</button>
            <button id="btn-xlsx" disabled>å¯¼å‡ºä¸º XLSX (Excel)</button>
          </div>
          <div id="status-msg">
            <span class="loading"></span> æ­£åœ¨ä» unpkg.com åˆå§‹åŒ– WebAssembly æ¨¡å—...
          </div>
        </section>

        <section>
          <h3>2. æ ¸å¿ƒä»£ç è®²è§£</h3>
          <p>ä½ åªéœ€è¦åœ¨ HTML ä¸­æ·»åŠ ä¸€æ®µ <code>&lt;script type="module"&gt;</code>ï¼Œç›´æ¥å¯¼å…¥ CDN ä¸Šçš„ JS æ–‡ä»¶ï¼š</p>
          <pre><code><span class="code-comment">&lt;!-- éœ€è¦è®¾ç½® type="module" æ”¯æŒ ES Modules --&gt;</span>
&lt;script <span class="code-keyword">type</span>="module"&gt;
  <span class="code-comment">// ä» unpkg å¼•å…¥ JS åŒ…è£…å™¨ã€‚å®ƒä¼šè‡ªåŠ¨è§£æç›¸å¯¹è·¯å¾„åŠ è½½ WASM</span>
  <span class="code-keyword">import</span> init, { export_table, ExportFormat } <span class="code-keyword">from</span> <span class="code-string">"https://unpkg.com/belobog-stellar-grid@1.0.8/pkg/belobog_stellar_grid.js"</span>;
  
  <span class="code-comment">// åˆå§‹åŒ– WebAssembly æ¨¡å—ï¼ˆä¼šè‡ªåŠ¨ä» CDN æ‹‰å– .wasm æ–‡ä»¶ï¼‰</span>
  <span class="code-keyword">await</span> <span class="code-function">init</span>();
  console.<span class="code-function">log</span>(<span class="code-string">"WASM åŠ è½½å®Œæˆï¼"</span>);

  <span class="code-comment">// ç»‘å®šæŒ‰é’®äº‹ä»¶å³å¯</span>
  document.<span class="code-function">getElementById</span>(<span class="code-string">'btn-csv'</span>).onclick = () =&gt; {
    <span class="code-function">export_table</span>(<span class="code-string">"demo-table"</span>, <span class="code-string">"CDN_ç¤ºä¾‹.csv"</span>, ExportFormat.Csv);
  };
&lt;/script&gt;</code></pre>
          <p><strong>æŠ€æœ¯åŸç†ï¼š</strong>ç”±äºåŒ…å†…å‘å¸ƒçš„æ˜¯æ ‡å‡†çš„ ES Modulesï¼Œè€Œä¸” WASM åˆå§‹åŒ–æ—¶ä½¿ç”¨çš„æ˜¯ <code>import.meta.url</code> æ¥ç¡®å®š <code>.wasm</code> åç¼€æ–‡ä»¶çš„è·¯å¾„ï¼Œå› æ­¤æµè§ˆå™¨èƒ½å¤ŸåŸç”Ÿåœ°è§£æåŸºäºåŒä¸€ CDN æºåœ°å€çš„ WASM æ–‡ä»¶ä¾èµ–ï¼Œä»è€Œå®ç°äº†å¼€ç®±å³ç”¨çš„ CDN åˆ†å‘ã€‚</p>
        </section>

      </article>
    </main>

    <script type="module">
      // æˆ‘ä»¬ç›´æ¥ä½¿ç”¨å·²å‘å¸ƒåœ¨ npm å¹¶ç¼“å­˜åˆ° unpkg ä¸Šçš„ 1.0.8 ç‰ˆæœ¬è¿›è¡Œæ¼”ç¤º
      // æ³¨æ„ï¼šå½“ä½ å‘å¸ƒæ–°ç‰ˆæœ¬åï¼Œå¯ä»¥æ›´æ–°è¿™é‡Œçš„ç‰ˆæœ¬å·æµ‹è¯•
      import init, { export_table, ExportFormat } from "https://unpkg.com/belobog-stellar-grid@1.0.8/pkg/belobog_stellar_grid.js";

      const btnCsv = document.getElementById("btn-csv");
      const btnXlsx = document.getElementById("btn-xlsx");
      const statusMsg = document.getElementById("status-msg");

      async function bootstrap() {
        try {
          // åˆå§‹åŒ– WASM
          await init();
          
          // æ›´æ–° UI
          statusMsg.innerHTML = '<span class="success">âœ… WASM åˆå§‹åŒ–æˆåŠŸï¼å¯ä»¥ç‚¹å‡»æŒ‰é’®å¯¼å‡ºäº†ã€‚</span>';
          btnCsv.disabled = false;
          btnXlsx.disabled = false;

          // ç»‘å®šäº‹ä»¶
          btnCsv.onclick = () => {
             export_table("demo-table", "CDN_ç¤ºä¾‹æ•°æ®.csv", ExportFormat.Csv);
          };
          btnXlsx.onclick = () => {
             export_table("demo-table", "CDN_ç¤ºä¾‹æ•°æ®.xlsx", ExportFormat.Xlsx);
          };
        } catch (e) {
          statusMsg.innerHTML = `<span class="error">âŒ WASM åŠ è½½å¤±è´¥ï¼š${e.message || e}</span>`;
          console.error(e);
        }
      }

      bootstrap();
    </script>
  </body>
</html>
